package Main = 
    use Math.factorial
    # use Option.Option
    # use Option.unwrap
    #use Opt.Option
    #use Opt.unwrap
    #use Opt.unwrap_or
    
   # extern println: str -> unit

    #extern concat: str -> str -> str
    #extern format: ?T -> str
    #extern exit: num -> unit

    pub type P = {
        d: str,
        f: str -> num -> str
    }

    pub type Option[?T] = |Some ?T, None|

    pub let None : Option[?T] = |None|

    let x = 3

    let id x : ?T -> ?T =
        x
    
    let main = 
         let a = Option.Some 2 in
         #   id a

        let b = Option.Some 3 in
           (unwrap a) * (unwrap b)

        # let i = S {d = "asdf", f = fn x y => concat x (display_num y)} in
        #    let en = Option.Some {"asdf"} in
        #         let f = factorial (unwrap en) in
        #                i.f i.d (f)
