package Main = 
    use Math.factorial
        
    extern println: str -> unit
 
    pub prop Functor = 
        fmap: Self -> (?A -> ?B) -> Functor[?B]
    
    pub type Option[?T] = |Some ?T, None|

    impl Functor for Option[?T] =
        def map o f : Self -> (?T -> ?U) -> Option[?U] =
            match o in
                | Some x| => |Some (f x)|,
                | None | =>  |None|,
          
    let main : infer = 
        let a = Some 2 in
        let b = Some 3 in
            a :: fmap (fn x => x * 2)
                +
            b :Functor: fmap (fn x => x * 3)
                      
